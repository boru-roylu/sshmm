vocab size =  30
Single state emissionprob entropy = 4.86
***** current_iter = 0; num_states = 3 *****
    Split index = None
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: []})
    Ordered idxs =  [0, 1, 2]
    Before training, entropy = [4.52 4.76 4.71]
    Before training, average entropy = 4.66
    Before training, transmat = 
[[0.6 0.2 0.2]
 [0.  0.6 0.4]
 [0.  0.  1. ]]
    Before training, ordered transmat = 
[[0.6 0.2 0.2]
 [0.  0.6 0.4]
 [0.  0.  1. ]]
    After training, entropy = [1.48 4.4  4.7 ]
    After training, average entropy = 3.53
    After training, transmat = 
[[0.34 0.61 0.04]
 [0.   0.88 0.12]
 [0.   0.   1.  ]]
    After training, ordered transmat = 
[[0.34 0.61 0.04]
 [0.   0.88 0.12]
 [0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: []})
    Current model Log Prob = -1839316.0147042598
    Current model PPL = -98197.95676619904



***** current_iter = 1; num_states = 4 *****
    Split index = 2
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [3]})
    Ordered idxs =  [0, 1, 2, 3]
    Before training, entropy = [1.48 4.4  4.7  4.7 ]
    Before training, average entropy = 3.82
    Before training, transmat = 
[[0.34 0.61 0.04 0.  ]
 [0.   0.88 0.12 0.  ]
 [0.   0.   0.5  0.5 ]
 [0.   0.   0.   1.  ]]
    Before training, ordered transmat = 
[[0.34 0.61 0.04 0.  ]
 [0.   0.88 0.12 0.  ]
 [0.   0.   0.5  0.5 ]
 [0.   0.   0.   1.  ]]
    After training, entropy = [0.45 4.27 4.43 4.65]
    After training, average entropy = 3.45
    After training, transmat = 
[[0.03 0.95 0.02 0.  ]
 [0.   0.86 0.14 0.  ]
 [0.   0.   0.87 0.13]
 [0.   0.   0.   1.  ]]
    After training, ordered transmat = 
[[0.03 0.95 0.02 0.  ]
 [0.   0.86 0.14 0.  ]
 [0.   0.   0.87 0.13]
 [0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [3]})
    Last model Log Prob = -1839316.0147042598
    Last model PPL = -98197.95676619904
    Current model Log Prob = -1813342.1100181374
    Current model PPL = -96811.25412835607



***** current_iter = 2; num_states = 5 *****
    Split index = 3
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [3], 3: [4]})
    Ordered idxs =  [0, 1, 2, 3, 4]
    Before training, entropy = [0.45 4.27 4.43 4.65 4.65]
    Before training, average entropy = 3.69
    Before training, transmat = 
[[0.03 0.95 0.02 0.   0.  ]
 [0.   0.86 0.14 0.   0.  ]
 [0.   0.   0.87 0.13 0.  ]
 [0.   0.   0.   0.5  0.5 ]
 [0.   0.   0.   0.   1.  ]]
    Before training, ordered transmat = 
[[0.03 0.95 0.02 0.   0.  ]
 [0.   0.86 0.14 0.   0.  ]
 [0.   0.   0.87 0.13 0.  ]
 [0.   0.   0.   0.5  0.5 ]
 [0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 4.11 4.6  3.82 4.56]
    After training, average entropy = 3.50
    After training, transmat = 
[[0.02 0.95 0.04 0.   0.  ]
 [0.   0.81 0.19 0.   0.  ]
 [0.   0.   0.96 0.04 0.  ]
 [0.   0.   0.   0.83 0.17]
 [0.   0.   0.   0.   1.  ]]
    After training, ordered transmat = 
[[0.02 0.95 0.04 0.   0.  ]
 [0.   0.81 0.19 0.   0.  ]
 [0.   0.   0.96 0.04 0.  ]
 [0.   0.   0.   0.83 0.17]
 [0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [3], 3: [4]})
    Last model Log Prob = -1813342.1100181374
    Last model PPL = -96811.25412835607
    Current model Log Prob = -1791547.0722779997
    Current model PPL = -95647.6540962714



***** current_iter = 3; num_states = 6 *****
    Split index = 2
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [5, 3], 3: [4]})
    Ordered idxs =  [0, 1, 2, 5, 3, 4]
    Before training, entropy = [0.42 4.11 4.6  4.6  3.82 4.56]
    Before training, average entropy = 3.69
    Before training, transmat = 
[[0.02 0.95 0.04 0.   0.   0.  ]
 [0.   0.81 0.19 0.   0.   0.  ]
 [0.   0.   0.48 0.04 0.   0.48]
 [0.   0.   0.   0.83 0.17 0.  ]
 [0.   0.   0.   0.   1.   0.  ]
 [0.   0.   0.   0.04 0.   0.96]]
    Before training, ordered transmat = 
[[0.02 0.95 0.04 0.   0.   0.  ]
 [0.   0.81 0.19 0.   0.   0.  ]
 [0.   0.   0.48 0.48 0.04 0.  ]
 [0.   0.   0.   0.96 0.04 0.  ]
 [0.   0.   0.   0.   0.83 0.17]
 [0.   0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 3.83 4.5  4.51 4.27 4.42]
    After training, average entropy = 3.66
    After training, transmat = 
[[0.02 0.92 0.06 0.   0.   0.  ]
 [0.   0.7  0.3  0.   0.   0.  ]
 [0.   0.   0.52 0.19 0.   0.29]
 [0.   0.   0.   0.94 0.06 0.  ]
 [0.   0.   0.   0.   1.   0.  ]
 [0.   0.   0.   0.02 0.   0.98]]
    After training, ordered transmat = 
[[0.02 0.92 0.06 0.   0.   0.  ]
 [0.   0.7  0.3  0.   0.   0.  ]
 [0.   0.   0.52 0.29 0.19 0.  ]
 [0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [5, 3], 3: [4]})
    Last model Log Prob = -1791547.0722779997
    Last model PPL = -95647.6540962714
    Current model Log Prob = -1768289.4422145234
    Current model PPL = -94405.96874519555



***** current_iter = 4; num_states = 7 *****
    Split index = 5
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [5, 3], 3: [4], 5: [6]})
    Ordered idxs =  [0, 1, 2, 5, 6, 3, 4]
    Before training, entropy = [0.42 3.83 4.5  4.51 4.51 4.27 4.42]
    Before training, average entropy = 3.78
    Before training, transmat = 
[[0.02 0.92 0.06 0.   0.   0.   0.  ]
 [0.   0.7  0.3  0.   0.   0.   0.  ]
 [0.   0.   0.52 0.19 0.   0.29 0.  ]
 [0.   0.   0.   0.94 0.06 0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.  ]
 [0.   0.   0.   0.02 0.   0.49 0.49]
 [0.   0.   0.   0.02 0.   0.   0.98]]
    Before training, ordered transmat = 
[[0.02 0.92 0.06 0.   0.   0.   0.  ]
 [0.   0.7  0.3  0.   0.   0.   0.  ]
 [0.   0.   0.52 0.29 0.   0.19 0.  ]
 [0.   0.   0.   0.49 0.49 0.02 0.  ]
 [0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 3.33 4.4  4.17 4.47 4.26 4.39]
    After training, average entropy = 3.63
    After training, transmat = 
[[0.01 0.89 0.1  0.   0.   0.   0.  ]
 [0.   0.46 0.54 0.   0.   0.   0.  ]
 [0.   0.   0.78 0.08 0.   0.13 0.  ]
 [0.   0.   0.   0.94 0.06 0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.63 0.36]
 [0.   0.   0.   0.02 0.   0.   0.98]]
    After training, ordered transmat = 
[[0.01 0.89 0.1  0.   0.   0.   0.  ]
 [0.   0.46 0.54 0.   0.   0.   0.  ]
 [0.   0.   0.78 0.13 0.   0.08 0.  ]
 [0.   0.   0.   0.63 0.36 0.   0.  ]
 [0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [5, 3], 3: [4], 5: [6]})
    Last model Log Prob = -1768289.4422145234
    Last model PPL = -94405.96874519555
    Current model Log Prob = -1756794.3180863347
    Current model PPL = -93792.26359983832



***** current_iter = 5; num_states = 8 *****
    Split index = 6
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [5, 3], 3: [4], 5: [6], 6: [7]})
    Ordered idxs =  [0, 1, 2, 5, 6, 7, 3, 4]
    Before training, entropy = [0.42 3.33 4.4  4.17 4.47 4.47 4.26 4.39]
    Before training, average entropy = 3.74
    Before training, transmat = 
[[0.01 0.89 0.1  0.   0.   0.   0.   0.  ]
 [0.   0.46 0.54 0.   0.   0.   0.   0.  ]
 [0.   0.   0.78 0.08 0.   0.13 0.   0.  ]
 [0.   0.   0.   0.94 0.06 0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.63 0.36 0.  ]
 [0.   0.   0.   0.02 0.   0.   0.49 0.49]
 [0.   0.   0.   0.02 0.   0.   0.   0.98]]
    Before training, ordered transmat = 
[[0.01 0.89 0.1  0.   0.   0.   0.   0.  ]
 [0.   0.46 0.54 0.   0.   0.   0.   0.  ]
 [0.   0.   0.78 0.13 0.   0.   0.08 0.  ]
 [0.   0.   0.   0.63 0.36 0.   0.   0.  ]
 [0.   0.   0.   0.   0.49 0.49 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 2.94 4.44 4.24 3.75 4.37 4.2  4.35]
    After training, average entropy = 3.59
    After training, transmat = 
[[0.01 0.82 0.16 0.   0.   0.   0.   0.  ]
 [0.   0.36 0.64 0.   0.   0.   0.   0.  ]
 [0.   0.   0.83 0.06 0.   0.12 0.   0.  ]
 [0.   0.   0.   0.94 0.06 0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.84 0.15 0.  ]
 [0.   0.   0.   0.03 0.   0.   0.71 0.26]
 [0.   0.   0.   0.02 0.   0.   0.   0.98]]
    After training, ordered transmat = 
[[0.01 0.82 0.16 0.   0.   0.   0.   0.  ]
 [0.   0.36 0.64 0.   0.   0.   0.   0.  ]
 [0.   0.   0.83 0.12 0.   0.   0.06 0.  ]
 [0.   0.   0.   0.84 0.15 0.   0.   0.  ]
 [0.   0.   0.   0.   0.71 0.26 0.03 0.  ]
 [0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [5, 3], 3: [4], 5: [6], 6: [7]})
    Last model Log Prob = -1756794.3180863347
    Last model PPL = -93792.26359983832
    Current model Log Prob = -1748351.0668259235
    Current model PPL = -93341.49276132674



***** current_iter = 6; num_states = 9 *****
    Split index = 2
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7]})
    Ordered idxs =  [0, 1, 2, 8, 5, 6, 7, 3, 4]
    Before training, entropy = [0.42 2.94 4.44 4.44 4.24 3.75 4.37 4.2  4.35]
    Before training, average entropy = 3.68
    Before training, transmat = 
[[0.01 0.82 0.16 0.   0.   0.   0.   0.   0.  ]
 [0.   0.36 0.64 0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.44 0.   0.   0.12 0.   0.   0.44]
 [0.   0.   0.   0.94 0.06 0.   0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.84 0.15 0.   0.  ]
 [0.   0.   0.   0.03 0.   0.   0.71 0.26 0.  ]
 [0.   0.   0.   0.02 0.   0.   0.   0.98 0.  ]
 [0.   0.   0.   0.06 0.   0.12 0.   0.   0.83]]
    Before training, ordered transmat = 
[[0.01 0.82 0.16 0.   0.   0.   0.   0.   0.  ]
 [0.   0.36 0.64 0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.44 0.44 0.12 0.   0.   0.   0.  ]
 [0.   0.   0.   0.83 0.12 0.   0.   0.06 0.  ]
 [0.   0.   0.   0.   0.84 0.15 0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.71 0.26 0.03 0.  ]
 [0.   0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 2.91 4.24 4.42 4.38 3.45 4.2  4.05 4.32]
    After training, average entropy = 3.60
    After training, transmat = 
[[0.01 0.75 0.24 0.   0.   0.   0.   0.   0.  ]
 [0.   0.26 0.74 0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.44 0.   0.   0.22 0.   0.   0.34]
 [0.   0.   0.   0.94 0.06 0.   0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.88 0.12 0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.88 0.11 0.  ]
 [0.   0.   0.   0.02 0.   0.   0.   0.98 0.  ]
 [0.   0.   0.   0.05 0.   0.07 0.   0.   0.88]]
    After training, ordered transmat = 
[[0.01 0.75 0.24 0.   0.   0.   0.   0.   0.  ]
 [0.   0.26 0.74 0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.44 0.34 0.22 0.   0.   0.   0.  ]
 [0.   0.   0.   0.88 0.07 0.   0.   0.05 0.  ]
 [0.   0.   0.   0.   0.88 0.12 0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.88 0.11 0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7]})
    Last model Log Prob = -1748351.0668259235
    Last model PPL = -93341.49276132674
    Current model Log Prob = -1736697.1461538617
    Current model PPL = -92719.30973830998



***** current_iter = 7; num_states = 10 *****
    Split index = 8
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7], 8: [9]})
    Ordered idxs =  [0, 1, 2, 8, 9, 5, 6, 7, 3, 4]
    Before training, entropy = [0.42 2.91 4.24 4.42 4.42 4.38 3.45 4.2  4.05 4.32]
    Before training, average entropy = 3.68
    Before training, transmat = 
[[0.01 0.75 0.24 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.26 0.74 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.44 0.   0.   0.22 0.   0.   0.34 0.  ]
 [0.   0.   0.   0.94 0.06 0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.88 0.12 0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.88 0.11 0.   0.  ]
 [0.   0.   0.   0.02 0.   0.   0.   0.98 0.   0.  ]
 [0.   0.   0.   0.   0.   0.07 0.   0.   0.46 0.46]
 [0.   0.   0.   0.05 0.   0.07 0.   0.   0.   0.88]]
    Before training, ordered transmat = 
[[0.01 0.75 0.24 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.26 0.74 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.44 0.34 0.   0.22 0.   0.   0.   0.  ]
 [0.   0.   0.   0.46 0.46 0.07 0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.88 0.07 0.   0.   0.05 0.  ]
 [0.   0.   0.   0.   0.   0.88 0.12 0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.88 0.11 0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 2.75 4.26 4.02 4.45 4.41 3.42 4.12 3.7  4.44]
    After training, average entropy = 3.60
    After training, transmat = 
[[0.01 0.69 0.3  0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.2  0.8  0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.51 0.   0.   0.24 0.   0.   0.25 0.  ]
 [0.   0.   0.   0.93 0.07 0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.89 0.1  0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.88 0.11 0.   0.  ]
 [0.   0.   0.   0.02 0.   0.   0.   0.98 0.   0.  ]
 [0.   0.   0.   0.   0.   0.07 0.   0.   0.57 0.36]
 [0.   0.   0.   0.02 0.   0.05 0.   0.   0.   0.93]]
    After training, ordered transmat = 
[[0.01 0.69 0.3  0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.2  0.8  0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.51 0.25 0.   0.24 0.   0.   0.   0.  ]
 [0.   0.   0.   0.57 0.36 0.07 0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.93 0.05 0.   0.   0.02 0.  ]
 [0.   0.   0.   0.   0.   0.89 0.1  0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.88 0.11 0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.93 0.07]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7], 8: [9]})
    Last model Log Prob = -1736697.1461538617
    Last model PPL = -92719.30973830998
    Current model Log Prob = -1732897.0970375964
    Current model PPL = -92516.43157281516



