vocab size =  30
Single state emissionprob entropy = 4.86
***** current_iter = 0; num_states = 3 *****
    Split index = None
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: []})
    Ordered idxs =  [0, 1, 2]
    Before training, entropy = [4.52 4.76 4.71]
    Before training, average entropy = 4.66
    Before training, transmat = 
[[0.6 0.2 0.2]
 [0.  0.6 0.4]
 [0.  0.  1. ]]
    Before training, ordered transmat = 
[[0.6 0.2 0.2]
 [0.  0.6 0.4]
 [0.  0.  1. ]]
    After training, entropy = [1.48 4.4  4.7 ]
    After training, average entropy = 3.53
    After training, transmat = 
[[0.34 0.61 0.04]
 [0.   0.88 0.12]
 [0.   0.   1.  ]]
    After training, ordered transmat = 
[[0.34 0.61 0.04]
 [0.   0.88 0.12]
 [0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: []})
    Current model Log Prob = -1839316.0147042598
    Current model PPL = -98197.95676619904



***** current_iter = 1; num_states = 4 *****
    Split index = 2
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [3]})
    Ordered idxs =  [0, 1, 2, 3]
    Before training, entropy = [1.48 4.4  4.7  4.7 ]
    Before training, average entropy = 3.82
    Before training, transmat = 
[[0.34 0.61 0.04 0.  ]
 [0.   0.88 0.12 0.  ]
 [0.   0.   0.5  0.5 ]
 [0.   0.   0.   1.  ]]
    Before training, ordered transmat = 
[[0.34 0.61 0.04 0.  ]
 [0.   0.88 0.12 0.  ]
 [0.   0.   0.5  0.5 ]
 [0.   0.   0.   1.  ]]
    After training, entropy = [0.45 4.27 4.43 4.65]
    After training, average entropy = 3.45
    After training, transmat = 
[[0.03 0.95 0.02 0.  ]
 [0.   0.86 0.14 0.  ]
 [0.   0.   0.87 0.13]
 [0.   0.   0.   1.  ]]
    After training, ordered transmat = 
[[0.03 0.95 0.02 0.  ]
 [0.   0.86 0.14 0.  ]
 [0.   0.   0.87 0.13]
 [0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [3]})
    Last model Log Prob = -1839316.0147042598
    Last model PPL = -98197.95676619904
    Current model Log Prob = -1813342.1100181374
    Current model PPL = -96811.25412835607



***** current_iter = 2; num_states = 5 *****
    Split index = 3
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [3], 3: [4]})
    Ordered idxs =  [0, 1, 2, 3, 4]
    Before training, entropy = [0.45 4.27 4.43 4.65 4.65]
    Before training, average entropy = 3.69
    Before training, transmat = 
[[0.03 0.95 0.02 0.   0.  ]
 [0.   0.86 0.14 0.   0.  ]
 [0.   0.   0.87 0.13 0.  ]
 [0.   0.   0.   0.5  0.5 ]
 [0.   0.   0.   0.   1.  ]]
    Before training, ordered transmat = 
[[0.03 0.95 0.02 0.   0.  ]
 [0.   0.86 0.14 0.   0.  ]
 [0.   0.   0.87 0.13 0.  ]
 [0.   0.   0.   0.5  0.5 ]
 [0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 4.11 4.6  3.82 4.56]
    After training, average entropy = 3.50
    After training, transmat = 
[[0.02 0.95 0.04 0.   0.  ]
 [0.   0.81 0.19 0.   0.  ]
 [0.   0.   0.96 0.04 0.  ]
 [0.   0.   0.   0.83 0.17]
 [0.   0.   0.   0.   1.  ]]
    After training, ordered transmat = 
[[0.02 0.95 0.04 0.   0.  ]
 [0.   0.81 0.19 0.   0.  ]
 [0.   0.   0.96 0.04 0.  ]
 [0.   0.   0.   0.83 0.17]
 [0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [3], 3: [4]})
    Last model Log Prob = -1813342.1100181374
    Last model PPL = -96811.25412835607
    Current model Log Prob = -1791547.072278
    Current model PPL = -95647.65409627142



***** current_iter = 3; num_states = 6 *****
    Split index = 2
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [5, 3], 3: [4]})
    Ordered idxs =  [0, 1, 2, 5, 3, 4]
    Before training, entropy = [0.42 4.11 4.6  4.6  3.82 4.56]
    Before training, average entropy = 3.69
    Before training, transmat = 
[[0.02 0.95 0.04 0.   0.   0.  ]
 [0.   0.81 0.19 0.   0.   0.  ]
 [0.   0.   0.48 0.04 0.   0.48]
 [0.   0.   0.   0.83 0.17 0.  ]
 [0.   0.   0.   0.   1.   0.  ]
 [0.   0.   0.   0.04 0.   0.96]]
    Before training, ordered transmat = 
[[0.02 0.95 0.04 0.   0.   0.  ]
 [0.   0.81 0.19 0.   0.   0.  ]
 [0.   0.   0.48 0.48 0.04 0.  ]
 [0.   0.   0.   0.96 0.04 0.  ]
 [0.   0.   0.   0.   0.83 0.17]
 [0.   0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 3.83 4.5  4.51 4.27 4.42]
    After training, average entropy = 3.66
    After training, transmat = 
[[0.02 0.92 0.06 0.   0.   0.  ]
 [0.   0.7  0.3  0.   0.   0.  ]
 [0.   0.   0.52 0.19 0.   0.29]
 [0.   0.   0.   0.94 0.06 0.  ]
 [0.   0.   0.   0.   1.   0.  ]
 [0.   0.   0.   0.02 0.   0.98]]
    After training, ordered transmat = 
[[0.02 0.92 0.06 0.   0.   0.  ]
 [0.   0.7  0.3  0.   0.   0.  ]
 [0.   0.   0.52 0.29 0.19 0.  ]
 [0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [5, 3], 3: [4]})
    Last model Log Prob = -1791547.072278
    Last model PPL = -95647.65409627142
    Current model Log Prob = -1768289.4422145232
    Current model PPL = -94405.96874519554



***** current_iter = 4; num_states = 7 *****
    Split index = 5
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [5, 3], 3: [4], 5: [6]})
    Ordered idxs =  [0, 1, 2, 5, 6, 3, 4]
    Before training, entropy = [0.42 3.83 4.5  4.51 4.51 4.27 4.42]
    Before training, average entropy = 3.78
    Before training, transmat = 
[[0.02 0.92 0.06 0.   0.   0.   0.  ]
 [0.   0.7  0.3  0.   0.   0.   0.  ]
 [0.   0.   0.52 0.19 0.   0.29 0.  ]
 [0.   0.   0.   0.94 0.06 0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.  ]
 [0.   0.   0.   0.02 0.   0.49 0.49]
 [0.   0.   0.   0.02 0.   0.   0.98]]
    Before training, ordered transmat = 
[[0.02 0.92 0.06 0.   0.   0.   0.  ]
 [0.   0.7  0.3  0.   0.   0.   0.  ]
 [0.   0.   0.52 0.29 0.   0.19 0.  ]
 [0.   0.   0.   0.49 0.49 0.02 0.  ]
 [0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 3.33 4.4  4.17 4.47 4.26 4.39]
    After training, average entropy = 3.63
    After training, transmat = 
[[0.01 0.89 0.1  0.   0.   0.   0.  ]
 [0.   0.46 0.54 0.   0.   0.   0.  ]
 [0.   0.   0.78 0.08 0.   0.13 0.  ]
 [0.   0.   0.   0.94 0.06 0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.63 0.36]
 [0.   0.   0.   0.02 0.   0.   0.98]]
    After training, ordered transmat = 
[[0.01 0.89 0.1  0.   0.   0.   0.  ]
 [0.   0.46 0.54 0.   0.   0.   0.  ]
 [0.   0.   0.78 0.13 0.   0.08 0.  ]
 [0.   0.   0.   0.63 0.36 0.   0.  ]
 [0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [5, 3], 3: [4], 5: [6]})
    Last model Log Prob = -1768289.4422145232
    Last model PPL = -94405.96874519554
    Current model Log Prob = -1756794.3180863352
    Current model PPL = -93792.26359983835



***** current_iter = 5; num_states = 8 *****
    Split index = 6
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [5, 3], 3: [4], 5: [6], 6: [7]})
    Ordered idxs =  [0, 1, 2, 5, 6, 7, 3, 4]
    Before training, entropy = [0.42 3.33 4.4  4.17 4.47 4.47 4.26 4.39]
    Before training, average entropy = 3.74
    Before training, transmat = 
[[0.01 0.89 0.1  0.   0.   0.   0.   0.  ]
 [0.   0.46 0.54 0.   0.   0.   0.   0.  ]
 [0.   0.   0.78 0.08 0.   0.13 0.   0.  ]
 [0.   0.   0.   0.94 0.06 0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.63 0.36 0.  ]
 [0.   0.   0.   0.02 0.   0.   0.49 0.49]
 [0.   0.   0.   0.02 0.   0.   0.   0.98]]
    Before training, ordered transmat = 
[[0.01 0.89 0.1  0.   0.   0.   0.   0.  ]
 [0.   0.46 0.54 0.   0.   0.   0.   0.  ]
 [0.   0.   0.78 0.13 0.   0.   0.08 0.  ]
 [0.   0.   0.   0.63 0.36 0.   0.   0.  ]
 [0.   0.   0.   0.   0.49 0.49 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 2.94 4.44 4.24 3.75 4.37 4.2  4.35]
    After training, average entropy = 3.59
    After training, transmat = 
[[0.01 0.82 0.16 0.   0.   0.   0.   0.  ]
 [0.   0.36 0.64 0.   0.   0.   0.   0.  ]
 [0.   0.   0.83 0.06 0.   0.12 0.   0.  ]
 [0.   0.   0.   0.94 0.06 0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.84 0.15 0.  ]
 [0.   0.   0.   0.03 0.   0.   0.71 0.26]
 [0.   0.   0.   0.02 0.   0.   0.   0.98]]
    After training, ordered transmat = 
[[0.01 0.82 0.16 0.   0.   0.   0.   0.  ]
 [0.   0.36 0.64 0.   0.   0.   0.   0.  ]
 [0.   0.   0.83 0.12 0.   0.   0.06 0.  ]
 [0.   0.   0.   0.84 0.15 0.   0.   0.  ]
 [0.   0.   0.   0.   0.71 0.26 0.03 0.  ]
 [0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [5, 3], 3: [4], 5: [6], 6: [7]})
    Last model Log Prob = -1756794.3180863352
    Last model PPL = -93792.26359983835
    Current model Log Prob = -1748351.0668259233
    Current model PPL = -93341.49276132672



***** current_iter = 6; num_states = 9 *****
    Split index = 2
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7]})
    Ordered idxs =  [0, 1, 2, 8, 5, 6, 7, 3, 4]
    Before training, entropy = [0.42 2.94 4.44 4.44 4.24 3.75 4.37 4.2  4.35]
    Before training, average entropy = 3.68
    Before training, transmat = 
[[0.01 0.82 0.16 0.   0.   0.   0.   0.   0.  ]
 [0.   0.36 0.64 0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.41 0.06 0.   0.12 0.   0.   0.41]
 [0.   0.   0.   0.94 0.06 0.   0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.84 0.15 0.   0.  ]
 [0.   0.   0.   0.03 0.   0.   0.71 0.26 0.  ]
 [0.   0.   0.   0.02 0.   0.   0.   0.98 0.  ]
 [0.   0.   0.   0.06 0.   0.12 0.   0.   0.83]]
    Before training, ordered transmat = 
[[0.01 0.82 0.16 0.   0.   0.   0.   0.   0.  ]
 [0.   0.36 0.64 0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.41 0.41 0.12 0.   0.   0.06 0.  ]
 [0.   0.   0.   0.83 0.12 0.   0.   0.06 0.  ]
 [0.   0.   0.   0.   0.84 0.15 0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.71 0.26 0.03 0.  ]
 [0.   0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 2.96 4.23 4.41 4.37 3.41 4.19 4.1  4.31]
    After training, average entropy = 3.60
    After training, transmat = 
[[0.01 0.77 0.21 0.   0.   0.   0.   0.   0.  ]
 [0.   0.28 0.72 0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.49 0.08 0.   0.2  0.   0.   0.23]
 [0.   0.   0.   0.94 0.06 0.   0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.88 0.12 0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.88 0.1  0.  ]
 [0.   0.   0.   0.02 0.   0.   0.   0.98 0.  ]
 [0.   0.   0.   0.02 0.   0.07 0.   0.   0.91]]
    After training, ordered transmat = 
[[0.01 0.77 0.21 0.   0.   0.   0.   0.   0.  ]
 [0.   0.28 0.72 0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.49 0.23 0.2  0.   0.   0.08 0.  ]
 [0.   0.   0.   0.91 0.07 0.   0.   0.02 0.  ]
 [0.   0.   0.   0.   0.88 0.12 0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.88 0.1  0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7]})
    Last model Log Prob = -1748351.0668259233
    Last model PPL = -93341.49276132672
    Current model Log Prob = -1733682.1068987567
    Current model PPL = -92558.34191545937



***** current_iter = 7; num_states = 10 *****
    Split index = 8
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7], 8: [9]})
    Ordered idxs =  [0, 1, 2, 8, 9, 5, 6, 7, 3, 4]
    Before training, entropy = [0.42 2.96 4.23 4.41 4.41 4.37 3.41 4.19 4.1  4.31]
    Before training, average entropy = 3.68
    Before training, transmat = 
[[0.01 0.77 0.21 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.28 0.72 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.49 0.08 0.   0.2  0.   0.   0.23 0.  ]
 [0.   0.   0.   0.94 0.06 0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.88 0.12 0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.88 0.1  0.   0.  ]
 [0.   0.   0.   0.02 0.   0.   0.   0.98 0.   0.  ]
 [0.   0.   0.   0.02 0.   0.07 0.   0.   0.46 0.46]
 [0.   0.   0.   0.02 0.   0.07 0.   0.   0.   0.91]]
    Before training, ordered transmat = 
[[0.01 0.77 0.21 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.28 0.72 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.49 0.23 0.   0.2  0.   0.   0.08 0.  ]
 [0.   0.   0.   0.46 0.46 0.07 0.   0.   0.02 0.  ]
 [0.   0.   0.   0.   0.91 0.07 0.   0.   0.02 0.  ]
 [0.   0.   0.   0.   0.   0.88 0.12 0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.88 0.1  0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 2.79 4.31 3.95 4.46 4.38 3.37 4.17 3.9  4.28]
    After training, average entropy = 3.60
    After training, transmat = 
[[0.01 0.73 0.26 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.22 0.78 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.58 0.06 0.   0.19 0.   0.   0.17 0.  ]
 [0.   0.   0.   0.93 0.07 0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.89 0.11 0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.91 0.08 0.   0.  ]
 [0.   0.   0.   0.02 0.   0.   0.   0.98 0.   0.  ]
 [0.   0.   0.   0.01 0.   0.06 0.   0.   0.67 0.26]
 [0.   0.   0.   0.01 0.   0.04 0.   0.   0.   0.95]]
    After training, ordered transmat = 
[[0.01 0.73 0.26 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.22 0.78 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.58 0.17 0.   0.19 0.   0.   0.06 0.  ]
 [0.   0.   0.   0.67 0.26 0.06 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.95 0.04 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.89 0.11 0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.91 0.08 0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.93 0.07]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7], 8: [9]})
    Last model Log Prob = -1733682.1068987567
    Last model PPL = -92558.34191545937
    Current model Log Prob = -1728468.4611510574
    Current model PPL = -92279.99422771351



***** current_iter = 8; num_states = 11 *****
    Split index = 9
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7], 8: [9], 9: [10]})
    Ordered idxs =  [0, 1, 2, 8, 9, 10, 5, 6, 7, 3, 4]
    Before training, entropy = [0.42 2.79 4.31 3.95 4.46 4.46 4.38 3.37 4.17 3.9  4.28]
    Before training, average entropy = 3.68
    Before training, transmat = 
[[0.01 0.73 0.26 0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.22 0.78 0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.58 0.06 0.   0.19 0.   0.   0.17 0.   0.  ]
 [0.   0.   0.   0.93 0.07 0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.89 0.11 0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.91 0.08 0.   0.   0.  ]
 [0.   0.   0.   0.02 0.   0.   0.   0.98 0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.06 0.   0.   0.67 0.26 0.  ]
 [0.   0.   0.   0.01 0.   0.04 0.   0.   0.   0.47 0.47]
 [0.   0.   0.   0.01 0.   0.04 0.   0.   0.   0.   0.95]]
    Before training, ordered transmat = 
[[0.01 0.73 0.26 0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.22 0.78 0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.58 0.17 0.   0.   0.19 0.   0.   0.06 0.  ]
 [0.   0.   0.   0.67 0.26 0.   0.06 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.47 0.47 0.04 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.95 0.04 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.89 0.11 0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.91 0.08 0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.93 0.07]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 2.65 4.3  4.02 4.51 4.4  4.38 3.35 4.15 3.86 4.29]
    After training, average entropy = 3.67
    After training, transmat = 
[[0.01 0.68 0.31 0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.18 0.82 0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.52 0.06 0.   0.2  0.   0.   0.22 0.   0.  ]
 [0.   0.   0.   0.93 0.07 0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.89 0.1  0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.91 0.08 0.   0.   0.  ]
 [0.   0.   0.   0.02 0.   0.   0.   0.98 0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.06 0.   0.   0.8  0.13 0.  ]
 [0.   0.   0.   0.01 0.   0.07 0.   0.   0.   0.53 0.4 ]
 [0.   0.   0.   0.01 0.   0.04 0.   0.   0.   0.   0.96]]
    After training, ordered transmat = 
[[0.01 0.68 0.31 0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.18 0.82 0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.52 0.22 0.   0.   0.2  0.   0.   0.06 0.  ]
 [0.   0.   0.   0.8  0.13 0.   0.06 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.53 0.4  0.07 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.96 0.04 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.89 0.1  0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.91 0.08 0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.93 0.07]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7], 8: [9], 9: [10]})
    Last model Log Prob = -1728468.4611510574
    Last model PPL = -92279.99422771351
    Current model Log Prob = -1725859.8046697269
    Current model PPL = -92140.72249065274



***** current_iter = 9; num_states = 12 *****
    Split index = 9
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7], 8: [9], 9: [11, 10]})
    Ordered idxs =  [0, 1, 2, 8, 9, 11, 10, 5, 6, 7, 3, 4]
    Before training, entropy = [0.42 2.65 4.3  4.02 4.51 4.51 4.4  4.38 3.35 4.15 3.86 4.29]
    Before training, average entropy = 3.74
    Before training, transmat = 
[[0.01 0.68 0.31 0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.18 0.82 0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.52 0.06 0.   0.2  0.   0.   0.22 0.   0.   0.  ]
 [0.   0.   0.   0.93 0.07 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.89 0.1  0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.91 0.08 0.   0.   0.   0.  ]
 [0.   0.   0.   0.02 0.   0.   0.   0.98 0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.06 0.   0.   0.8  0.13 0.   0.  ]
 [0.   0.   0.   0.01 0.   0.07 0.   0.   0.   0.26 0.4  0.26]
 [0.   0.   0.   0.01 0.   0.04 0.   0.   0.   0.   0.96 0.  ]
 [0.   0.   0.   0.01 0.   0.07 0.   0.   0.   0.   0.4  0.53]]
    Before training, ordered transmat = 
[[0.01 0.68 0.31 0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.18 0.82 0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.52 0.22 0.   0.   0.   0.2  0.   0.   0.06 0.  ]
 [0.   0.   0.   0.8  0.13 0.   0.   0.06 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.26 0.26 0.4  0.07 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.53 0.4  0.07 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.96 0.04 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.89 0.1  0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.91 0.08 0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.98 0.02 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.93 0.07]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 2.62 4.24 4.11 4.47 3.97 4.34 4.35 3.29 4.13 3.78 4.27]
    After training, average entropy = 3.67
    After training, transmat = 
[[0.01 0.63 0.35 0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.16 0.84 0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.47 0.05 0.   0.18 0.   0.   0.29 0.   0.   0.  ]
 [0.   0.   0.   0.94 0.06 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.89 0.1  0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.93 0.06 0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.   0.99 0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.05 0.   0.   0.8  0.14 0.   0.  ]
 [0.   0.   0.   0.01 0.   0.05 0.   0.   0.   0.28 0.37 0.28]
 [0.   0.   0.   0.01 0.   0.04 0.   0.   0.   0.   0.96 0.  ]
 [0.   0.   0.   0.   0.   0.04 0.   0.   0.   0.   0.04 0.91]]
    After training, ordered transmat = 
[[0.01 0.63 0.35 0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.16 0.84 0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.47 0.29 0.   0.   0.   0.18 0.   0.   0.05 0.  ]
 [0.   0.   0.   0.8  0.14 0.   0.   0.05 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.28 0.28 0.37 0.05 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.91 0.04 0.04 0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.96 0.04 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.89 0.1  0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.93 0.06 0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.99 0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7], 8: [9], 9: [11, 10]})
    Last model Log Prob = -1725859.8046697269
    Last model PPL = -92140.72249065274
    Current model Log Prob = -1720341.7931513276
    Current model PPL = -91846.12523156985



***** current_iter = 10; num_states = 13 *****
    Split index = 9
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7], 8: [9], 9: [12, 11, 10]})
    Ordered idxs =  [0, 1, 2, 8, 9, 12, 11, 10, 5, 6, 7, 3, 4]
    Before training, entropy = [0.42 2.62 4.24 4.11 4.47 4.47 3.97 4.34 4.35 3.29 4.13 3.78 4.27]
    Before training, average entropy = 3.73
    Before training, transmat = 
[[0.01 0.63 0.35 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.16 0.84 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.47 0.05 0.   0.18 0.   0.   0.29 0.   0.   0.   0.  ]
 [0.   0.   0.   0.94 0.06 0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.89 0.1  0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.93 0.06 0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.   0.99 0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.05 0.   0.   0.8  0.14 0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.05 0.   0.   0.   0.14 0.37 0.28 0.14]
 [0.   0.   0.   0.01 0.   0.04 0.   0.   0.   0.   0.96 0.   0.  ]
 [0.   0.   0.   0.   0.   0.04 0.   0.   0.   0.   0.04 0.91 0.  ]
 [0.   0.   0.   0.01 0.   0.05 0.   0.   0.   0.   0.37 0.28 0.28]]
    Before training, ordered transmat = 
[[0.01 0.63 0.35 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.16 0.84 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.47 0.29 0.   0.   0.   0.   0.18 0.   0.   0.05 0.  ]
 [0.   0.   0.   0.8  0.14 0.   0.   0.   0.05 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.14 0.14 0.28 0.37 0.05 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.28 0.28 0.37 0.05 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.91 0.04 0.04 0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.96 0.04 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.89 0.1  0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.93 0.06 0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.99 0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 2.58 4.12 4.17 4.56 4.08 4.02 4.31 4.32 3.21 4.09 3.54 4.59]
    After training, average entropy = 3.69
    After training, transmat = 
[[0.01 0.56 0.43 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.14 0.86 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.4  0.03 0.   0.16 0.   0.   0.41 0.   0.   0.   0.  ]
 [0.   0.   0.   0.94 0.06 0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   1.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.88 0.12 0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.94 0.05 0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.   0.99 0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.04 0.   0.   0.78 0.16 0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.03 0.   0.   0.   0.1  0.31 0.36 0.19]
 [0.   0.   0.   0.01 0.   0.04 0.   0.   0.   0.   0.95 0.   0.  ]
 [0.   0.   0.   0.   0.   0.04 0.   0.   0.   0.   0.02 0.95 0.  ]
 [0.   0.   0.   0.   0.   0.03 0.   0.   0.   0.   0.1  0.12 0.74]]
    After training, ordered transmat = 
[[0.01 0.56 0.43 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.14 0.86 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.4  0.41 0.   0.   0.   0.   0.16 0.   0.   0.03 0.  ]
 [0.   0.   0.   0.78 0.16 0.   0.   0.   0.04 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.1  0.19 0.36 0.31 0.03 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.74 0.12 0.1  0.03 0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.95 0.02 0.04 0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.95 0.04 0.   0.   0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.88 0.12 0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.94 0.05 0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.99 0.01 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.94 0.06]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7], 8: [9], 9: [12, 11, 10]})
    Last model Log Prob = -1720341.7931513276
    Last model PPL = -91846.12523156985
    Current model Log Prob = -1713514.3879492094
    Current model PPL = -91481.62166855883



***** current_iter = 11; num_states = 14 *****
    Split index = 4
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7], 8: [9], 9: [12, 11, 10], 4: [13]})
    Ordered idxs =  [0, 1, 2, 8, 9, 12, 11, 10, 5, 6, 7, 3, 4, 13]
    Before training, entropy = [0.42 2.58 4.12 4.17 4.56 4.08 4.02 4.31 4.32 3.21 4.09 3.54 4.59 4.59]
    Before training, average entropy = 3.76
    Before training, transmat = 
[[0.01 0.56 0.43 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.14 0.86 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.4  0.03 0.   0.16 0.   0.   0.41 0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.94 0.06 0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.5  0.   0.   0.   0.   0.   0.   0.   0.   0.5 ]
 [0.   0.   0.   0.   0.   0.88 0.12 0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.94 0.05 0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.   0.   0.99 0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.04 0.   0.   0.78 0.16 0.   0.   0.   0.  ]
 [0.   0.   0.   0.01 0.   0.03 0.   0.   0.   0.1  0.31 0.36 0.19 0.  ]
 [0.   0.   0.   0.01 0.   0.04 0.   0.   0.   0.   0.95 0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.04 0.   0.   0.   0.   0.02 0.95 0.   0.  ]
 [0.   0.   0.   0.   0.   0.03 0.   0.   0.   0.   0.1  0.12 0.74 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    Before training, ordered transmat = 
[[0.01 0.56 0.43 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.14 0.86 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.4  0.41 0.   0.   0.   0.   0.16 0.   0.   0.03 0.   0.  ]
 [0.   0.   0.   0.78 0.16 0.   0.   0.   0.04 0.   0.   0.01 0.   0.  ]
 [0.   0.   0.   0.   0.1  0.19 0.36 0.31 0.03 0.   0.   0.01 0.   0.  ]
 [0.   0.   0.   0.   0.   0.74 0.12 0.1  0.03 0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.95 0.02 0.04 0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.95 0.04 0.   0.   0.01 0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.88 0.12 0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.94 0.05 0.01 0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.99 0.01 0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.94 0.06 0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.5  0.5 ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
    After training, entropy = [0.42 2.56 3.89 4.19 4.6  3.84 4.03 4.28 4.36 3.17 4.05 3.46 4.27 4.61]
    After training, average entropy = 3.70
    After training, transmat = 
[[1.14e-02 4.52e-01 5.36e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 1.34e-01 8.66e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 3.15e-01 2.48e-02 0.00e+00 1.56e-01 0.00e+00 0.00e+00
  5.04e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 9.33e-01 6.68e-02 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 8.15e-01 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 1.85e-01]
 [0.00e+00 0.00e+00 0.00e+00 4.52e-03 0.00e+00 8.54e-01 1.42e-01 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 8.20e-03 0.00e+00 0.00e+00 9.48e-01 4.34e-02
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 1.42e-02 0.00e+00 0.00e+00 0.00e+00 9.86e-01
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 1.58e-02 0.00e+00 4.67e-02 0.00e+00 0.00e+00
  7.73e-01 1.65e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 1.01e-02 0.00e+00 2.32e-02 0.00e+00 0.00e+00
  0.00e+00 7.09e-02 3.35e-01 3.63e-01 1.97e-01 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 9.75e-03 0.00e+00 4.14e-02 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 9.49e-01 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 1.33e-03 0.00e+00 3.88e-02 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 1.39e-02 9.46e-01 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 6.84e-04 0.00e+00 8.03e-03 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 2.92e-02 5.36e-02 9.08e-01 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 1.00e+00]]
    After training, ordered transmat = 
[[1.14e-02 4.52e-01 5.36e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 1.34e-01 8.66e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 3.15e-01 5.04e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  1.56e-01 0.00e+00 0.00e+00 2.48e-02 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 7.73e-01 1.65e-01 0.00e+00 0.00e+00 0.00e+00
  4.67e-02 0.00e+00 0.00e+00 1.58e-02 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 7.09e-02 1.97e-01 3.63e-01 3.35e-01
  2.32e-02 0.00e+00 0.00e+00 1.01e-02 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 9.08e-01 5.36e-02 2.92e-02
  8.03e-03 0.00e+00 0.00e+00 6.84e-04 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 9.46e-01 1.39e-02
  3.88e-02 0.00e+00 0.00e+00 1.33e-03 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 9.49e-01
  4.14e-02 0.00e+00 0.00e+00 9.75e-03 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  8.54e-01 1.42e-01 0.00e+00 4.52e-03 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 9.48e-01 4.34e-02 8.20e-03 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 9.86e-01 1.42e-02 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 9.33e-01 6.68e-02 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 8.15e-01 1.85e-01]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 1.00e+00]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7], 8: [9], 9: [12, 11, 10], 4: [13]})
    Last model Log Prob = -1713514.3879492094
    Last model PPL = -91481.62166855883
    Current model Log Prob = -1708949.0691985951
    Current model PPL = -91237.8870575878



***** current_iter = 12; num_states = 15 *****
    Split index = 13
    State transmat info =  defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7], 8: [9], 9: [12, 11, 10], 4: [13], 13: [14]})
    Ordered idxs =  [0, 1, 2, 8, 9, 12, 11, 10, 5, 6, 7, 3, 4, 13, 14]
    Before training, entropy = [0.42 2.56 3.89 4.19 4.6  3.84 4.03 4.28 4.36 3.17 4.05 3.46 4.27 4.61
 4.61]
    Before training, average entropy = 3.76
    Before training, transmat = 
[[1.14e-02 4.52e-01 5.36e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 1.34e-01 8.66e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 3.15e-01 2.48e-02 0.00e+00 1.56e-01 0.00e+00 0.00e+00
  5.04e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 9.33e-01 6.68e-02 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 8.15e-01 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 1.85e-01 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 4.52e-03 0.00e+00 8.54e-01 1.42e-01 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 8.20e-03 0.00e+00 0.00e+00 9.48e-01 4.34e-02
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 1.42e-02 0.00e+00 0.00e+00 0.00e+00 9.86e-01
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 1.58e-02 0.00e+00 4.67e-02 0.00e+00 0.00e+00
  7.73e-01 1.65e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 1.01e-02 0.00e+00 2.32e-02 0.00e+00 0.00e+00
  0.00e+00 7.09e-02 3.35e-01 3.63e-01 1.97e-01 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 9.75e-03 0.00e+00 4.14e-02 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 9.49e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 1.33e-03 0.00e+00 3.88e-02 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 1.39e-02 9.46e-01 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 6.84e-04 0.00e+00 8.03e-03 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 2.92e-02 5.36e-02 9.08e-01 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 5.00e-01 5.00e-01]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 1.00e+00]]
    Before training, ordered transmat = 
[[1.14e-02 4.52e-01 5.36e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 1.34e-01 8.66e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 3.15e-01 5.04e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  1.56e-01 0.00e+00 0.00e+00 2.48e-02 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 7.73e-01 1.65e-01 0.00e+00 0.00e+00 0.00e+00
  4.67e-02 0.00e+00 0.00e+00 1.58e-02 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 7.09e-02 1.97e-01 3.63e-01 3.35e-01
  2.32e-02 0.00e+00 0.00e+00 1.01e-02 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 9.08e-01 5.36e-02 2.92e-02
  8.03e-03 0.00e+00 0.00e+00 6.84e-04 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 9.46e-01 1.39e-02
  3.88e-02 0.00e+00 0.00e+00 1.33e-03 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 9.49e-01
  4.14e-02 0.00e+00 0.00e+00 9.75e-03 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  8.54e-01 1.42e-01 0.00e+00 4.52e-03 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 9.48e-01 4.34e-02 8.20e-03 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 9.86e-01 1.42e-02 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 9.33e-01 6.68e-02 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 8.15e-01 1.85e-01 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 5.00e-01 5.00e-01]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 1.00e+00]]
    After training, entropy = [0.42 2.59 3.61 4.2  4.62 3.97 4.01 4.29 4.35 3.13 4.08 3.44 4.46 3.51
 4.59]
    After training, average entropy = 3.68
    After training, transmat = 
[[9.41e-03 3.60e-01 6.30e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 1.67e-01 8.33e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 2.23e-01 2.36e-02 0.00e+00 1.43e-01 0.00e+00 0.00e+00
  6.10e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 9.26e-01 7.42e-02 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 9.36e-01 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 6.39e-02 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 5.45e-03 0.00e+00 8.40e-01 1.55e-01 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 1.02e-02 0.00e+00 0.00e+00 9.49e-01 4.05e-02
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 1.49e-02 0.00e+00 0.00e+00 0.00e+00 9.85e-01
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 1.85e-02 0.00e+00 5.42e-02 0.00e+00 0.00e+00
  7.60e-01 1.67e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 1.16e-02 0.00e+00 1.99e-02 0.00e+00 0.00e+00
  0.00e+00 5.51e-02 3.36e-01 3.28e-01 2.49e-01 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 1.03e-02 0.00e+00 4.20e-02 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 9.48e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 1.66e-03 0.00e+00 4.09e-02 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 1.25e-02 9.45e-01 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 6.13e-04 0.00e+00 1.98e-02 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 2.03e-02 3.39e-02 9.25e-01 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 7.42e-01 2.58e-01]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 1.00e+00]]
    After training, ordered transmat = 
[[9.41e-03 3.60e-01 6.30e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 1.67e-01 8.33e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 2.23e-01 6.10e-01 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  1.43e-01 0.00e+00 0.00e+00 2.36e-02 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 7.60e-01 1.67e-01 0.00e+00 0.00e+00 0.00e+00
  5.42e-02 0.00e+00 0.00e+00 1.85e-02 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 5.51e-02 2.49e-01 3.28e-01 3.36e-01
  1.99e-02 0.00e+00 0.00e+00 1.16e-02 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 9.25e-01 3.39e-02 2.03e-02
  1.98e-02 0.00e+00 0.00e+00 6.13e-04 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 9.45e-01 1.25e-02
  4.09e-02 0.00e+00 0.00e+00 1.66e-03 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 9.48e-01
  4.20e-02 0.00e+00 0.00e+00 1.03e-02 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  8.40e-01 1.55e-01 0.00e+00 5.45e-03 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 9.49e-01 4.05e-02 1.02e-02 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 9.85e-01 1.49e-02 0.00e+00 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 9.26e-01 7.42e-02 0.00e+00 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 9.36e-01 6.39e-02 0.00e+00]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 7.42e-01 2.58e-01]
 [0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00
  0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 0.00e+00 1.00e+00]]
    State_transmat_info = defaultdict(<class 'list'>, {0: [], 1: [], 2: [8, 5, 3], 3: [4], 5: [6], 6: [7], 8: [9], 9: [12, 11, 10], 4: [13], 13: [14]})
    Last model Log Prob = -1708949.0691985951
    Last model PPL = -91237.8870575878
    Current model Log Prob = -1706038.3136299143
    Current model PPL = -91082.4867635626



